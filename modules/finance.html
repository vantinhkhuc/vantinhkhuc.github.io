<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module T√†i Ch√≠nh</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        /* Navigation */
        nav {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
        }

        .logo {
            padding: 20px 30px;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            list-style: none;
            flex: 1;
        }

        .nav-links li {
            position: relative;
        }

        .nav-links a {
            display: block;
            padding: 25px 20px;
            color: white;
            text-decoration: none;
            transition: background 0.3s;
        }

        .nav-links a:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-links a.active {
            background: rgba(255,255,255,0.2);
            border-bottom: 3px solid white;
        }

        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .page-header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .page-header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .page-header p {
            color: #666;
        }

        /* Dashboard Styles */
        .market-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .market-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }

        .market-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .market-card h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .market-card .value {
            font-size: 32px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .market-card .change {
            font-size: 18px;
            font-weight: 600;
        }

        .market-card .change.positive {
            color: #26a69a;
        }

        .market-card .change.negative {
            color: #ef5350;
        }

        .market-card .volume {
            font-size: 12px;
            color: #999;
            margin-top: 10px;
        }

        /* Tables */
        .data-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .data-section h2 {
            margin-bottom: 20px;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* Charts */
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        canvas {
            max-width: 100%;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: #f0f0f0;
            color: #333;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #e0e0e0;
        }

        .btn.active {
            background: #667eea;
            color: white;
        }

        /* Indicators */
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .indicator-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .indicator-card .label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .indicator-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .indicator-card .signal {
            font-size: 12px;
            margin-top: 5px;
            padding: 3px 8px;
            border-radius: 3px;
            display: inline-block;
        }

        .signal.buy {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .signal.sell {
            background: #ffcdd2;
            color: #c62828;
        }

        .signal.neutral {
            background: #fff3e0;
            color: #e65100;
        }

        /* Financial Statements */
        .statement-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .statement-tabs button {
            padding: 12px 24px;
            border: none;
            background: none;
            cursor: pointer;
            color: #666;
            font-weight: 600;
            transition: all 0.3s;
        }

        .statement-tabs button:hover {
            color: #667eea;
        }

        .statement-tabs button.active {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            margin-bottom: -2px;
        }

        .statement-content {
            display: none;
        }

        .statement-content.active {
            display: block;
        }

        /* Macro Analysis */
        .macro-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .macro-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .macro-card h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .macro-metric {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .macro-metric:last-child {
            border-bottom: none;
        }

        .macro-metric .label {
            color: #666;
        }

        .macro-metric .value {
            font-weight: 600;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
            }
            
            .nav-links a {
                padding: 15px 20px;
            }

            .market-overview {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="logo">üí∞ Finance</div>
            <ul class="nav-links">
                <li><a href="#" data-view="dashboard" class="active">Dashboard</a></li>
                <li><a href="#" data-view="technical">Ph√¢n T√≠ch K·ªπ Thu·∫≠t</a></li>
                <li><a href="#" data-view="fundamental">Ph√¢n T√≠ch C∆° B·∫£n</a></li>
                <li><a href="#" data-view="macro">Ph√¢n T√≠ch Vƒ© M√¥</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div id="app-content">
            <div class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
        </div>
    </div>

    <script>
        // ============ DATA SAMPLES ============
        const sampleData = {
            dashboard: {
                lastUpdate: "2025-10-05T15:30:00Z",
                markets: [
                    { name: "VN-Index", value: 1250.5, change: 15.3, changePercent: 1.24, volume: 500000000 },
                    { name: "HNX-Index", value: 235.8, change: -2.1, changePercent: -0.88, volume: 120000000 },
                    { name: "UPCOM", value: 85.6, change: 0.8, changePercent: 0.94, volume: 50000000 },
                    { name: "S&P 500", value: 4580.5, change: 25.3, changePercent: 0.56, volume: 3200000000 }
                ],
                topGainers: [
                    { symbol: "VNM", name: "Vinamilk", price: 85.5, change: 3.2, changePercent: 3.89, volume: 2500000 },
                    { symbol: "VIC", name: "Vingroup", price: 42.3, change: 2.1, changePercent: 5.23, volume: 5000000 },
                    { symbol: "HPG", name: "H√≤a Ph√°t", price: 28.9, change: 1.5, changePercent: 5.47, volume: 8000000 },
                    { symbol: "VCB", name: "Vietcombank", price: 95.2, change: 3.8, changePercent: 4.16, volume: 3500000 },
                    { symbol: "FPT", name: "FPT Corp", price: 125.5, change: 5.5, changePercent: 4.58, volume: 1500000 }
                ],
                topLosers: [
                    { symbol: "MSN", name: "Masan", price: 62.5, change: -2.8, changePercent: -4.29, volume: 3200000 },
                    { symbol: "VHM", name: "Vinhomes", price: 58.3, change: -2.1, changePercent: -3.48, volume: 4500000 },
                    { symbol: "MWG", name: "Mobile World", price: 48.2, change: -1.8, changePercent: -3.60, volume: 2800000 },
                    { symbol: "TCB", name: "Techcombank", price: 52.6, change: -1.5, changePercent: -2.77, volume: 2100000 },
                    { symbol: "VRE", name: "Vincom Retail", price: 29.8, change: -1.2, changePercent: -3.87, volume: 1800000 }
                ]
            },
            technical: {
                symbol: "VNM",
                name: "Vinamilk",
                currentPrice: 85.5,
                timeframes: {
                    "1day": [
                        { time: "01/10", open: 82.0, high: 83.5, low: 81.5, close: 82.8, volume: 2500000 },
                        { time: "02/10", open: 82.8, high: 84.2, low: 82.0, close: 83.5, volume: 2800000 },
                        { time: "03/10", open: 83.5, high: 85.0, low: 83.0, close: 84.2, volume: 3200000 },
                        { time: "04/10", open: 84.2, high: 86.0, low: 83.8, close: 85.5, volume: 3500000 },
                        { time: "05/10", open: 85.5, high: 86.5, low: 85.0, close: 85.8, volume: 2900000 }
                    ],
                    "1week": [
                        { time: "T36", open: 78.5, high: 82.0, low: 77.0, close: 80.5, volume: 15000000 },
                        { time: "T37", open: 80.5, high: 83.5, low: 79.5, close: 82.8, volume: 18000000 },
                        { time: "T38", open: 82.8, high: 85.0, low: 82.0, close: 84.2, volume: 16500000 },
                        { time: "T39", open: 84.2, high: 86.5, low: 83.5, close: 85.5, volume: 17200000 }
                    ],
                    "1month": [
                        { time: "T7", open: 75.0, high: 78.5, low: 73.0, close: 77.5, volume: 65000000 },
                        { time: "T8", open: 77.5, high: 82.0, low: 76.0, close: 80.8, volume: 72000000 },
                        { time: "T9", open: 80.8, high: 86.5, low: 80.0, close: 85.5, volume: 68000000 }
                    ]
                },
                indicators: {
                    rsi: { value: 65.5, signal: "Mua" },
                    macd: { value: 2.5, signal: 2.0, histogram: 0.5, trend: "TƒÉng" },
                    ma20: 82.5,
                    ma50: 78.2,
                    ma200: 72.8,
                    bollinger: { upper: 88.5, middle: 85.0, lower: 81.5 },
                    stochastic: { k: 78.5, d: 75.2, signal: "Qu√° mua" }
                },
                analysis: "Xu h∆∞·ªõng tƒÉng m·∫°nh trong ng·∫Øn h·∫°n. RSI cho t√≠n hi·ªáu mua, MACD d∆∞∆°ng v√† ƒëang tƒÉng. Gi√° ƒëang n·∫±m tr√™n MA20, MA50 cho th·∫•y xu h∆∞·ªõng tƒÉng. Khuy·∫øn ngh·ªã: MUA"
            },
            fundamental: {
                symbol: "VNM",
                name: "Vinamilk",
                sector: "H√†ng ti√™u d√πng",
                overview: {
                    marketCap: "101,250 t·ª∑ VND",
                    pe: 18.5,
                    pb: 3.2,
                    eps: 4620,
                    dividend: 3.5,
                    roe: 25.8,
                    roa: 15.2
                },
                incomeStatement: [
                    { year: "2024", revenue: 62500, grossProfit: 28500, operatingIncome: 18200, netIncome: 14800 },
                    { year: "2023", revenue: 58200, grossProfit: 26500, operatingIncome: 16800, netIncome: 13500 },
                    { year: "2022", revenue: 54800, grossProfit: 24200, operatingIncome: 15200, netIncome: 12200 }
                ],
                balanceSheet: [
                    { year: "2024", totalAssets: 98500, totalLiabilities: 28500, equity: 70000 },
                    { year: "2023", totalAssets: 92000, totalLiabilities: 26800, equity: 65200 },
                    { year: "2022", totalAssets: 88500, totalLiabilities: 25200, equity: 63300 }
                ],
                cashFlow: [
                    { year: "2024", operating: 16500, investing: -8200, financing: -5500, net: 2800 },
                    { year: "2023", operating: 15200, investing: -7500, financing: -4800, net: 2900 },
                    { year: "2022", operating: 14800, investing: -6800, financing: -5200, net: 2800 }
                ],
                analysis: "C√¥ng ty c√≥ hi·ªáu su·∫•t t√†i ch√≠nh t·ªët v·ªõi ROE cao. Doanh thu tƒÉng tr∆∞·ªüng ·ªïn ƒë·ªãnh qua c√°c nƒÉm. T·ª∑ l·ªá n·ª£/v·ªën ch·ªß th·∫•p cho th·∫•y c·∫•u tr√∫c t√†i ch√≠nh l√†nh m·∫°nh. P/E h·ª£p l√Ω so v·ªõi ng√†nh. Khuy·∫øn ngh·ªã: MUA v√† N·∫ÆM GI·ªÆ."
            },
            macro: {
                vietnam: {
                    gdp: { value: "7.2%", trend: "up", description: "TƒÉng tr∆∞·ªüng GDP qu√Ω 3/2025" },
                    inflation: { value: "3.8%", trend: "stable", description: "CPI th√°ng 9/2025" },
                    unemployment: { value: "2.3%", trend: "down", description: "T·ª∑ l·ªá th·∫•t nghi·ªáp Q3/2025" },
                    interest: { value: "4.5%", trend: "stable", description: "L√£i su·∫•t c∆° b·∫£n" },
                    exchange: { value: "24,350", trend: "up", description: "VND/USD" },
                    fdi: { value: "$28.5B", trend: "up", description: "V·ªën FDI 9 th√°ng" }
                },
                global: {
                    usgdp: { value: "2.8%", trend: "stable", description: "US GDP Q3/2025" },
                    fedrate: { value: "5.25-5.50%", trend: "stable", description: "L√£i su·∫•t Fed" },
                    oil: { value: "$85.5", trend: "up", description: "Gi√° d·∫ßu WTI/th√πng" },
                    gold: { value: "$1,985", trend: "up", description: "V√†ng/ounce" },
                    vix: { value: "15.2", trend: "down", description: "Ch·ªâ s·ªë bi·∫øn ƒë·ªông" }
                },
                analysis: "Kinh t·∫ø Vi·ªát Nam duy tr√¨ ƒë√† tƒÉng tr∆∞·ªüng t·ªët. L·∫°m ph√°t ƒë∆∞·ª£c ki·ªÉm so√°t trong m·ª•c ti√™u. FDI tƒÉng m·∫°nh cho th·∫•y ni·ªÅm tin nh√† ƒë·∫ßu t∆∞. ƒê·ªìng USD tƒÉng gi√° t√°c ƒë·ªông ƒë·∫øn xu·∫•t kh·∫©u nh∆∞ng ki·ªÉm so√°t ƒë∆∞·ª£c. Tri·ªÉn v·ªçng t√≠ch c·ª±c cho th·ªã tr∆∞·ªùng ch·ª©ng kho√°n."
            }
        };

        // ============ FINANCE MODULE ============
        const FinanceModule = {
            currentView: 'dashboard',
            currentTimeframe: '1day',
            data: {},

            async init(view = 'dashboard') {
                this.currentView = view;
                await this.loadData();
                this.render();
                this.attachEvents();
            },

            async loadData() {
                // Trong th·ª±c t·∫ø, s·∫Ω fetch t·ª´ file JSON
                // const response = await fetch(`data/finance/${this.currentView}.json`);
                // this.data = await response.json();
                
                // Demo: d√πng d·ªØ li·ªáu m·∫´u
                this.data = sampleData[this.currentView];
            },

            render() {
                const container = document.getElementById('app-content');
                const templates = {
                    'dashboard': this.renderDashboard.bind(this),
                    'technical': this.renderTechnical.bind(this),
                    'fundamental': this.renderFundamental.bind(this),
                    'macro': this.renderMacro.bind(this)
                };
                
                container.innerHTML = templates[this.currentView]();
                
                // V·∫Ω bi·ªÉu ƒë·ªì n·∫øu c·∫ßn
                if (this.currentView === 'technical') {
                    this.drawCandlestickChart();
                }
            },

            renderDashboard() {
                const data = this.data;
                return `
                    <div class="page-header">
                        <h1>üìä Dashboard Th·ªã Tr∆∞·ªùng</h1>
                        <p>C·∫≠p nh·∫≠t l√∫c: ${new Date(data.lastUpdate).toLocaleString('vi-VN')}</p>
                    </div>

                    <div class="market-overview">
                        ${data.markets.map(m => `
                            <div class="market-card">
                                <h3>${m.name}</h3>
                                <div class="value">${m.value.toLocaleString('vi-VN', {minimumFractionDigits: 2})}</div>
                                <div class="change ${m.change > 0 ? 'positive' : 'negative'}">
                                    ${m.change > 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(m.change).toFixed(2)} (${Math.abs(m.changePercent).toFixed(2)}%)
                                </div>
                                <div class="volume">Vol: ${(m.volume / 1000000).toFixed(1)}M</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="data-section">
                        <h2>üöÄ Top TƒÉng Gi√°</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>M√£ CK</th>
                                    <th>T√™n c√¥ng ty</th>
                                    <th>Gi√°</th>
                                    <th>Thay ƒë·ªïi</th>
                                    <th>% Thay ƒë·ªïi</th>
                                    <th>Kh·ªëi l∆∞·ª£ng</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${data.topGainers.map(stock => `
                                    <tr>
                                        <td><strong>${stock.symbol}</strong></td>
                                        <td>${stock.name}</td>
                                        <td>${stock.price.toLocaleString('vi-VN')}</td>
                                        <td style="color: #26a69a;">+${stock.change.toFixed(1)}</td>
                                        <td style="color: #26a69a; font-weight: 600;">+${stock.changePercent.toFixed(2)}%</td>
                                        <td>${(stock.volume / 1000000).toFixed(2)}M</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div class="data-section">
                        <h2>üìâ Top Gi·∫£m Gi√°</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>M√£ CK</th>
                                    <th>T√™n c√¥ng ty</th>
                                    <th>Gi√°</th>
                                    <th>Thay ƒë·ªïi</th>
                                    <th>% Thay ƒë·ªïi</th>
                                    <th>Kh·ªëi l∆∞·ª£ng</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${data.topLosers.map(stock => `
                                    <tr>
                                        <td><strong>${stock.symbol}</strong></td>
                                        <td>${stock.name}</td>
                                        <td>${stock.price.toLocaleString('vi-VN')}</td>
                                        <td style="color: #ef5350;">${stock.change.toFixed(1)}</td>
                                        <td style="color: #ef5350; font-weight: 600;">${stock.changePercent.toFixed(2)}%</td>
                                        <td>${(stock.volume / 1000000).toFixed(2)}M</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            },

            renderTechnical() {
                const data = this.data;
                return `
                    <div class="page-header">
                        <h1>üìà Ph√¢n T√≠ch K·ªπ Thu·∫≠t</h1>
                        <p>${data.symbol} - ${data.name} | Gi√° hi·ªán t·∫°i: ${data.currentPrice.toLocaleString('vi-VN')} VND</p>
                    </div>

                    <div class="indicators-grid">
                        <div class="indicator-card">
                            <div class="label">RSI (14)</div>
                            <div class="value">${data.indicators.rsi.value}</div>
                            <div class="signal ${data.indicators.rsi.signal === 'Mua' ? 'buy' : 'neutral'}">${data.indicators.rsi.signal}</div>
                        </div>
                        <div class="indicator-card">
                            <div class="label">MACD</div>
                            <div class="value">${data.indicators.macd.value}</div>
                            <div class="signal ${data.indicators.macd.trend === 'TƒÉng' ? 'buy' : 'neutral'}">${data.indicators.macd.trend}</div>
                        </div>
                        <div class="indicator-card">
                            <div class="label">MA20</div>
                            <div class="value">${data.indicators.ma20}</div>
                            <div class="signal ${data.currentPrice > data.indicators.ma20 ? 'buy' : 'sell'}">
                                ${data.currentPrice > data.indicators.ma20 ? 'Tr√™n MA20' : 'D∆∞·ªõi MA20'}
                            </div>
                        </div>
                        <div class="indicator-card">
                            <div class="label">MA50</div>
                            <div class="value">${data.indicators.ma50}</div>
                            <div class="signal ${data.currentPrice > data.indicators.ma50 ? 'buy' : 'sell'}">
                                ${data.currentPrice > data.indicators.ma50 ? 'Tr√™n MA50' : 'D∆∞·ªõi MA50'}
                            </div>
                        </div>
                        <div class="indicator-card">
                            <div class="label">Stochastic</div>
                            <div class="value">${data.indicators.stochastic.k.toFixed(1)}</div>
                            <div class="signal ${data.indicators.stochastic.k > 80 ? 'sell' : data.indicators.stochastic.k < 20 ? 'buy' : 'neutral'}">
                                ${data.indicators.stochastic.signal}
                            </div>
                        </div>
                        <div class="indicator-card">
                            <div class="label">Bollinger Bands</div>
                            <div class="value" style="font-size: 14px;">
                                U: ${data.indicators.bollinger.upper}<br>
                                M: ${data.indicators.bollinger.middle}<br>
                                L: ${data.indicators.bollinger.lower}
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h2>Bi·ªÉu ƒê·ªì N·∫øn</h2>
                        <div class="controls">
                            <button class="btn active" data-timeframe="1day">1 Ng√†y</button>
                            <button class="btn" data-timeframe="1week">1 Tu·∫ßn</button>
                            <button class="btn" data-timeframe="1month">1 Th√°ng</button>
                        </div>
                        <canvas id="technicalChart"></canvas>
                        <canvas id="volumeChart"></canvas>
                    </div>

                    <div class="data-section">
                        <h2>üí° Nh·∫≠n ƒê·ªãnh</h2>
                        <p style="line-height: 1.8; font-size: 16px;">${data.analysis}</p>
                    </div>
                `;
            },

            renderFundamental() {
                const data = this.data;
                return `
                    <div class="page-header">
                        <h1>üìä Ph√¢n T√≠ch C∆° B·∫£n</h1>
                        <p>${data.symbol} - ${data.name} | Ng√†nh: ${data.sector}</p>
                    </div>

                    <div class="data-section">
                        <h2>üìà T·ªïng Quan T√†i Ch√≠nh</h2>
                        <div class="indicators-grid">
                            <div class="indicator-card">
                                <div class="label">V·ªën h√≥a th·ªã tr∆∞·ªùng</div>
                                <div class="value" style="font-size: 20px;">${data.overview.marketCap}</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">P/E Ratio</div>
                                <div class="value">${data.overview.pe}</div>
                                <div class="signal neutral">Trung b√¨nh</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">P/B Ratio</div>
                                <div class="value">${data.overview.pb}</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">EPS (VND)</div>
                                <div class="value">${data.overview.eps.toLocaleString()}</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">C·ªï t·ª©c (%)</div>
                                <div class="value">${data.overview.dividend}%</div>
                                <div class="signal buy">H·∫•p d·∫´n</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">ROE (%)</div>
                                <div class="value">${data.overview.roe}%</div>
                                <div class="signal buy">Cao</div>
                            </div>
                            <div class="indicator-card">
                                <div class="label">ROA (%)</div>
                                <div class="value">${data.overview.roa}%</div>
                            </div>
                        </div>
                    </div>

                    <div class="data-section">
                        <h2>üí∞ B√°o C√°o T√†i Ch√≠nh</h2>
                        <div class="statement-tabs">
                            <button class="active" data-statement="income">B√°o C√°o Thu Nh·∫≠p</button>
                            <button data-statement="balance">B·∫£ng C√¢n ƒê·ªëi</button>
                            <button data-statement="cashflow">L∆∞u Chuy·ªÉn Ti·ªÅn T·ªá</button>
                        </div>

                        <div id="statement-income" class="statement-content active">
                            <table>
                                <thead>
                                    <tr>
                                        <th>NƒÉm</th>
                                        <th>Doanh Thu (t·ª∑ VND)</th>
                                        <th>L·ª£i Nhu·∫≠n G·ªôp (t·ª∑ VND)</th>
                                        <th>L·ª£i Nhu·∫≠n Ho·∫°t ƒê·ªông (t·ª∑ VND)</th>
                                        <th>L·ª£i Nhu·∫≠n R√≤ng (t·ª∑ VND)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.incomeStatement.map(row => `
                                        <tr>
                                            <td><strong>${row.year}</strong></td>
                                            <td>${row.revenue.toLocaleString()}</td>
                                            <td>${row.grossProfit.toLocaleString()}</td>
                                            <td>${row.operatingIncome.toLocaleString()}</td>
                                            <td style="color: #26a69a; font-weight: 600;">${row.netIncome.toLocaleString()}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>

                        <div id="statement-balance" class="statement-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>NƒÉm</th>
                                        <th>T·ªïng T√†i S·∫£n (t·ª∑ VND)</th>
                                        <th>T·ªïng N·ª£ (t·ª∑ VND)</th>
                                        <th>V·ªën Ch·ªß S·ªü H·ªØu (t·ª∑ VND)</th>
                                        <th>N·ª£/V·ªën</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.balanceSheet.map(row => `
                                        <tr>
                                            <td><strong>${row.year}</strong></td>
                                            <td>${row.totalAssets.toLocaleString()}</td>
                                            <td>${row.totalLiabilities.toLocaleString()}</td>
                                            <td style="color: #26a69a; font-weight: 600;">${row.equity.toLocaleString()}</td>
                                            <td>${(row.totalLiabilities / row.equity).toFixed(2)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>

                        <div id="statement-cashflow" class="statement-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>NƒÉm</th>
                                        <th>Ho·∫°t ƒê·ªông Kinh Doanh (t·ª∑ VND)</th>
                                        <th>Ho·∫°t ƒê·ªông ƒê·∫ßu T∆∞ (t·ª∑ VND)</th>
                                        <th>Ho·∫°t ƒê·ªông T√†i Ch√≠nh (t·ª∑ VND)</th>
                                        <th>D√≤ng Ti·ªÅn R√≤ng (t·ª∑ VND)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.cashFlow.map(row => `
                                        <tr>
                                            <td><strong>${row.year}</strong></td>
                                            <td style="color: #26a69a;">${row.operating.toLocaleString()}</td>
                                            <td style="color: #ef5350;">${row.investing.toLocaleString()}</td>
                                            <td style="color: #ef5350;">${row.financing.toLocaleString()}</td>
                                            <td style="font-weight: 600;">${row.net.toLocaleString()}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="data-section">
                        <h2>üí° ƒê√°nh Gi√°</h2>
                        <p style="line-height: 1.8; font-size: 16px;">${data.analysis}</p>
                    </div>
                `;
            },

            renderMacro() {
                const data = this.data;
                const getTrendIcon = (trend) => {
                    return trend === 'up' ? 'üìà' : trend === 'down' ? 'üìâ' : '‚û°Ô∏è';
                };
                
                return `
                    <div class="page-header">
                        <h1>üåç Ph√¢n T√≠ch Vƒ© M√¥</h1>
                        <p>T·ªïng quan kinh t·∫ø Vi·ªát Nam v√† Th·∫ø gi·ªõi</p>
                    </div>

                    <div class="data-section">
                        <h2>üáªüá≥ Kinh T·∫ø Vi·ªát Nam</h2>
                        <div class="macro-grid">
                            ${Object.entries(data.vietnam).map(([key, item]) => `
                                <div class="macro-card">
                                    <h3>${getTrendIcon(item.trend)} ${item.description}</h3>
                                    <div class="macro-metric">
                                        <span class="label">Gi√° tr·ªã hi·ªán t·∫°i</span>
                                        <span class="value" style="font-size: 24px; color: #667eea;">${item.value}</span>
                                    </div>
                                    <div class="macro-metric">
                                        <span class="label">Xu h∆∞·ªõng</span>
                                        <span class="value">${item.trend === 'up' ? 'TƒÉng' : item.trend === 'down' ? 'Gi·∫£m' : '·ªîn ƒë·ªãnh'}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="data-section">
                        <h2>üåê Kinh T·∫ø To√†n C·∫ßu</h2>
                        <div class="macro-grid">
                            ${Object.entries(data.global).map(([key, item]) => `
                                <div class="macro-card">
                                    <h3>${getTrendIcon(item.trend)} ${item.description}</h3>
                                    <div class="macro-metric">
                                        <span class="label">Gi√° tr·ªã hi·ªán t·∫°i</span>
                                        <span class="value" style="font-size: 24px; color: #667eea;">${item.value}</span>
                                    </div>
                                    <div class="macro-metric">
                                        <span class="label">Xu h∆∞·ªõng</span>
                                        <span class="value">${item.trend === 'up' ? 'TƒÉng' : item.trend === 'down' ? 'Gi·∫£m' : '·ªîn ƒë·ªãnh'}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="data-section">
                        <h2>üí° Ph√¢n T√≠ch & Tri·ªÉn V·ªçng</h2>
                        <p style="line-height: 1.8; font-size: 16px;">${data.analysis}</p>
                    </div>
                `;
            },

            drawCandlestickChart() {
                const data = this.data.timeframes[this.currentTimeframe];
                const candleCanvas = document.getElementById('technicalChart');
                const volumeCanvas = document.getElementById('volumeChart');
                
                if (!candleCanvas || !volumeCanvas) return;

                this.drawCandles(candleCanvas, data);
                this.drawVolume(volumeCanvas, data);
            },

            drawCandles(canvas, data) {
                const ctx = canvas.getContext('2d');
                const width = Math.max(800, data.length * 80);
                const height = 400;
                canvas.width = width;
                canvas.height = height;

                const padding = {top: 40, right: 60, bottom: 40, left: 60};
                const chartWidth = width - padding.left - padding.right;
                const chartHeight = height - padding.top - padding.bottom;

                const allPrices = data.flatMap(d => [d.high, d.low]);
                const maxPrice = Math.max(...allPrices);
                const minPrice = Math.min(...allPrices);
                const priceRange = maxPrice - minPrice;

                ctx.clearRect(0, 0, width, height);
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, width, height);

                // Grid
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = padding.top + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(padding.left, y);
                    ctx.lineTo(width - padding.right, y);
                    ctx.stroke();

                    const price = maxPrice - (priceRange / 5) * i;
                    ctx.fillStyle = '#666';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'right';
                    ctx.fillText(price.toFixed(1), padding.left - 10, y + 4);
                }

                // Candles
                const candleWidth = Math.min(50, chartWidth / data.length * 0.7);
                const spacing = chartWidth / data.length;

                data.forEach((item, index) => {
                    const x = padding.left + spacing * index + spacing / 2;
                    
                    const highY = padding.top + (maxPrice - item.high) / priceRange * chartHeight;
                    const lowY = padding.top + (maxPrice - item.low) / priceRange * chartHeight;
                    const openY = padding.top + (maxPrice - item.open) / priceRange * chartHeight;
                    const closeY = padding.top + (maxPrice - item.close) / priceRange * chartHeight;

                    const isGreen = item.close >= item.open;
                    const color = isGreen ? '#26a69a' : '#ef5350';

                    // Wick
                    ctx.strokeStyle = color;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(x, highY);
                    ctx.lineTo(x, lowY);
                    ctx.stroke();

                    // Body
                    const bodyTop = Math.min(openY, closeY);
                    const bodyHeight = Math.abs(closeY - openY) || 1;
                    
                    ctx.fillStyle = color;
                    ctx.fillRect(x - candleWidth / 2, bodyTop, candleWidth, bodyHeight);

                    // Time labels
                    ctx.fillStyle = '#666';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(item.time, x, height - padding.bottom + 20);
                });

                // Title
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('Bi·ªÉu ƒê·ªì N·∫øn Nh·∫≠t', padding.left, 25);
            },

            drawVolume(canvas, data) {
                const ctx = canvas.getContext('2d');
                const width = Math.max(800, data.length * 80);
                const height = 150;
                canvas.width = width;
                canvas.height = height;

                const padding = {top: 10, right: 60, bottom: 40, left: 60};
                const chartWidth = width - padding.left - padding.right;
                const chartHeight = height - padding.top - padding.bottom;

                const maxVolume = Math.max(...data.map(d => d.volume));

                ctx.clearRect(0, 0, width, height);
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, width, height);

                // Grid
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 3; i++) {
                    const y = padding.top + (chartHeight / 3) * i;
                    ctx.beginPath();
                    ctx.moveTo(padding.left, y);
                    ctx.lineTo(width - padding.right, y);
                    ctx.stroke();

                    const vol = maxVolume - (maxVolume / 3) * i;
                    ctx.fillStyle = '#666';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'right';
                    ctx.fillText((vol / 1000000).toFixed(1) + 'M', padding.left - 10, y + 4);
                }

                // Volume bars
                const barWidth = Math.min(50, chartWidth / data.length * 0.7);
                const spacing = chartWidth / data.length;

                data.forEach((item, index) => {
                    const x = padding.left + spacing * index + spacing / 2;
                    const barHeight = (item.volume / maxVolume) * chartHeight;
                    const y = padding.top + chartHeight - barHeight;

                    const isGreen = item.close >= item.open;
                    const color = isGreen ? 'rgba(38, 166, 154, 0.6)' : 'rgba(239, 83, 80, 0.6)';

                    ctx.fillStyle = color;
                    ctx.fillRect(x - barWidth / 2, y, barWidth, barHeight);
                });

                // Title
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('Kh·ªëi L∆∞·ª£ng Giao D·ªãch', padding.left, 25);
            },

            attachEvents() {
                // Navigation
                document.querySelectorAll('.nav-links a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        document.querySelectorAll('.nav-links a').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                        this.init(link.dataset.view);
                    });
                });

                // Timeframe buttons for technical analysis
                if (this.currentView === 'technical') {
                    document.querySelectorAll('.controls .btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                            document.querySelectorAll('.controls .btn').forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                            this.currentTimeframe = btn.dataset.timeframe;
                            this.drawCandlestickChart();
                        });
                    });
                }

                // Financial statement tabs
                if (this.currentView === 'fundamental') {
                    document.querySelectorAll('.statement-tabs button').forEach(btn => {
                        btn.addEventListener('click', () => {
                            document.querySelectorAll('.statement-tabs button').forEach(b => b.classList.remove('active'));
                            document.querySelectorAll('.statement-content').forEach(c => c.classList.remove('active'));
                            
                            btn.classList.add('active');
                            document.getElementById(`statement-${btn.dataset.statement}`).classList.add('active');
                        });
                    });
                }
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            FinanceModule.init('dashboard');
        });
    </script>
</body>
</html>
